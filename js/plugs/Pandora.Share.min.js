(function($){$.fn.extend({Share:function(options){var config={type:"wechat",title:["Share to Timeline","Share to Friends"],desc:"Simple for this",sharePic:["http://pandorajs.com/share_ico.jpg","http://pandorajs.com/share_ico.jpg"],shareLink:[location.href,location.href],shareApi:"http://wx.pandorajs.com/API/wxshare.ashx",jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","hideMenuItems"],readyShare:function(){},jsApiFN:{onMenuShareTimeline:[function(){},function(){},function(){}],onMenuShareAppMessage:[function(){},function(){},function(){}]},debug:false},share=$.extend(config,options);switch(share.type){case"wechat":isWechat();break}function isWechat(){var JSSDK="http://res.wx.qq.com/open/js/jweixin-1.0.0.js";$.getScript(JSSDK,function(){$.ajax({url:share.shareApi,dataType:"jsonp",data:"url="+encodeURIComponent(location.href),success:function(datas){wx.config({debug:share.debug,appId:datas.appId,timestamp:datas.timestamp,nonceStr:datas.nonceStr,signature:datas.signature,jsApiList:share.jsApiList});wx.ready(function(){share.readyShare();wx.onMenuShareTimeline({title:ArryChecker("title")[0],link:ArryChecker("link")[0],imgUrl:ArryChecker("img")[0],success:share.jsApiFN.onMenuShareTimeline[0],cancel:share.jsApiFN.onMenuShareTimeline[1],trigger:share.jsApiFN.onMenuShareTimeline[2]});wx.onMenuShareAppMessage({title:ArryChecker("title")[1],desc:share.desc,link:ArryChecker("link")[1],imgUrl:ArryChecker("img")[1],success:share.jsApiFN.onMenuShareAppMessage[0],cancel:share.jsApiFN.onMenuShareAppMessage[1],trigger:share.jsApiFN.onMenuShareAppMessage[2]})})}})});function ArryChecker(type){switch(type){case"title":if(share.title.length===1){share.title[1]=share.title[0]}return share.title;case"link":if(share.shareLink.length===1){share.shareLink[1]=share.shareLink[0]}return share.shareLink;case"img":if(share.sharePic.length===1){share.sharePic[1]=share.sharePic[0]}return share.sharePic}}}}})})(jQuery);
